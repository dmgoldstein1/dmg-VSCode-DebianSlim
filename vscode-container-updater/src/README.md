# VS Code Container Updater Extension

Generated by Copilot (GPT-4o), 2025-08-30

This directory contains two different implementations of the VS Code Container Updater extension, each designed for different deployment scenarios.

## üìÅ File Overview

### `extension.ts` (PRIMARY - Currently Used)

#### Internal Container Monitoring

- **Purpose**: Monitors VS Code CLI updates from INSIDE the container
- **Used by**: package.json ‚Üí "main": "./out/extension.js"
- **Deployment**: Extension runs inside VS Code container/tunnel

### `extension-external-monitor.ts` (ALTERNATIVE - Reference)

#### External Container Monitoring**

- **Purpose**: Monitors VS Code containers from HOST machine
- **Used by**: Alternative implementation for external monitoring
- **Deployment**: Extension runs on host VS Code, monitors containers via Docker CLI

## üèóÔ∏è Architecture Comparison

| Feature | Internal (extension.ts) | External (extension-external-monitor.ts) |
|---------|------------------------|-------------------------------------------|
| **Location** | Inside container | Host machine |
| **Log Access** | Direct filesystem: `~/LOGS/*.log` | Docker command: `docker logs` |
| **Approval** | Local file: `touch $HOME/APPROVE_CODE_UPDATE` | Remote exec: `docker exec container touch` |
| **Dependencies** | Filesystem access | Docker CLI access |
| **Configuration** | Automatic | Requires container name setting |
| **Use Case** | Production tunnel | Development/debugging |

## üöÄ Current Production Setup

The build system uses **`extension.ts`** (internal monitoring) because:

1. **Docker Integration**: The Dockerfile installs the extension inside the container
2. **Tunnel Architecture**: VS Code runs as a tunnel service inside the container  
3. **Log Availability**: Entrypoint script creates logs at `~/LOGS/` inside container
4. **Simplicity**: No external Docker dependencies required

## üîß Switching to External Monitoring

To use external monitoring instead:

1. **Replace the main file**:

   ```bash
   cp src/extension-external-monitor.ts src/extension.ts
   ```

2. **Configure container name** in VS Code settings:

   ```json
   {
     "vscode-container-updater.containerName": "your-container-name"
   }
   ```

3. **Ensure Docker CLI access** from host machine

4. **Recompile and package**:

   ```bash
   npm run compile
   npx @vscode/vsce package
   ```

## üéØ When to Use Each Approach

### Use Internal Monitoring (`extension.ts`) when

- ‚úÖ Running VS Code tunnel in Docker container
- ‚úÖ Standard deployment scenario
- ‚úÖ Extension installed inside container
- ‚úÖ Single-container setup

### Use External Monitoring (`extension-external-monitor.ts`) when

- ‚úÖ Monitoring containers from host VS Code
- ‚úÖ Development and debugging scenarios
- ‚úÖ Multi-container orchestration
- ‚úÖ Centralized monitoring needs
- ‚úÖ CI/CD or automated testing

## üìö Implementation Details

Both implementations provide the same user interface:

- Status bar indicator for update status
- Notification popups when updates are available
- Commands for checking updates and approving installation
- Configuration options for monitoring intervals

The key difference is **where** the extension runs and **how** it communicates with the container environment.

## üîç Troubleshooting

### Internal Monitoring Issues

- Check if `~/LOGS/entrypoint-log-*.log` files exist
- Verify extension is installed inside container
- Ensure proper file permissions for approval file creation

### External Monitoring Issues

- Verify Docker CLI is accessible: `docker ps`
- Check container name configuration
- Ensure container is running: `docker ps | grep container-name`
- Verify Docker daemon permissions
