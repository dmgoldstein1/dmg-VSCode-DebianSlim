# VS Code Container Updater Extension

<!-- Generated by Copilot (GPT-4) on 2025-08-29 -->
<!-- This extension monitors VS Code containers for CLI updates and provides GUI notifications -->

A minimal VS Code extension that monitors containerized VS Code environments for CLI updates and provides convenient GUI notifications with one-click approval.

## Features

- **Automatic Monitoring**: Continuously monitors your VS Code container for available updates
- **GUI Notifications**: Shows native VS Code notifications when updates are available
- **One-Click Approval**: Approve updates directly from the VS Code interface
- **Status Bar Integration**: Real-time update status in the status bar
- **Configurable**: Customize container name and check intervals

## Installation

### From Source

1. Clone or download this extension to your local machine
2. Open the extension folder in VS Code
3. Run `npm install` to install dependencies
4. Run `npm run compile` to build the extension
5. Press `F5` to run the extension in a new Extension Development Host window

### Manual Installation

1. Package the extension: `vsce package` (requires `npm install -g vsce`)
2. Install the generated `.vsix` file: `code --install-extension vscode-container-updater-0.0.1.vsix`

## Configuration

Open VS Code settings and search for "Container Updater" to configure:

- **Container Name**: Name of your VS Code container (default: `vscode-server-tunnel`)
- **Check Interval**: How often to check for updates in seconds (default: 300 = 5 minutes)
- **Auto Check**: Whether to automatically monitor for updates (default: true)

## Usage

### Automatic Monitoring

Once installed and configured, the extension will automatically:

1. Check if your container is running
2. Parse container logs for update notifications
3. Show GUI notifications when updates are available
4. Display status in the status bar

### Manual Commands

Available commands (accessible via Command Palette `Ctrl+Shift+P`):

- **Container Updater: Check Container Updates** - Manually check for updates
- **Container Updater: Approve VS Code Update** - Approve pending updates
- **Container Updater: Configure Container Settings** - Open extension settings

### Status Bar

The status bar shows current update status:
- ✅ **Up to date** - No updates available
- ⚠️ **Update Available!** - Click to check details
- ⚠️ **Container not running** - Container is not active
- ❌ **Check failed** - Error occurred during check

### Update Workflow

1. Extension detects update in container logs
2. Shows notification: "VS Code CLI update available: 1.85.0 → 1.86.0"
3. Click "Approve Update" to create approval file in container
4. Container automatically installs update on next check cycle
5. Extension confirms update completion

## How It Works

The extension monitors your VS Code container by:

1. **Container Detection**: Checks if the configured container is running using `docker ps`
2. **Log Parsing**: Reads recent container logs using `docker logs` to find update notifications
3. **Pattern Matching**: Looks for specific update messages like:
   ```
   Update available for VS Code CLI (installed: 1.85.0, candidate: 1.86.0)
   ```
4. **Approval Mechanism**: Creates the approval file using:
   ```bash
   docker exec [container] bash -c "touch $HOME/APPROVE_CODE_UPDATE"
   ```

## Requirements

- VS Code 1.74.0 or higher
- Docker installed and accessible from VS Code's terminal
- A running VS Code container created by the build script in this repository

## Extension Settings

This extension contributes the following settings:

- `vscode-container-updater.containerName`: Name of the container to monitor
- `vscode-container-updater.checkInterval`: Check interval in seconds
- `vscode-container-updater.autoCheck`: Enable automatic monitoring

## Known Issues

- Requires Docker to be accessible from VS Code's integrated terminal
- Only monitors containers created by the build script in this repository
- Parsing relies on specific log message formats

## Release Notes

### 0.0.1

Initial release with basic monitoring and approval functionality.

## Development

To contribute or modify this extension:

```bash
# Install dependencies
npm install

# Compile TypeScript
npm run compile

# Watch for changes during development
npm run watch

# Test in development
# Press F5 in VS Code to launch Extension Development Host
```

## License

This extension follows the same licensing terms as the parent VS Code container project.
