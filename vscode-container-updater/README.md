# VS Code Container Updater Extension

<!-- Generated by Copilot (GPT-4) on 2025-08-29 -->
<!-- This extension monitors the local VS Code CLI for updates and provides GUI notifications -->

A VS Code extension that runs inside containerized VS Code environments to monitor for VS Code CLI updates and provides convenient GUI notifications with one-click approval.

## Features

- **Automatic Monitoring**: Continuously monitors the local VS Code CLI for available updates
- **GUI Notifications**: Shows native VS Code notifications when updates are available
- **One-Click Approval**: Approve updates directly from the VS Code interface
- **Status Bar Integration**: Real-time update status in the status bar
- **Local Operation**: Runs entirely within the container, no external dependencies

## Installation

This extension is automatically installed when building the containerized VS Code environment. It's included in the Docker build process and will be available immediately when you connect to your VS Code server.

### Manual Installation (Development)

1. Clone or download this extension to your local machine
2. Open the extension folder in VS Code
3. Run `npm install` to install dependencies
4. Run `npm run compile` to build the extension
5. Press `F5` to run the extension in a new Extension Development Host window

## Configuration

Open VS Code settings and search for "Container Updater" to configure:

- **Check Interval**: How often to check for updates in seconds (default: 300 = 5 minutes)
- **Auto Check**: Whether to automatically monitor for updates (default: true)

## Usage

### Automatic Monitoring

The extension automatically starts when VS Code loads and will:

1. Monitor the local system logs for VS Code CLI update notifications
2. Show GUI notifications when updates are available
3. Display current status in the status bar

### Manual Commands

Available commands (accessible via Command Palette `Ctrl+Shift+P`):

- **Container Updater: Check for VS Code CLI Updates** - Manually check for updates
- **Container Updater: Approve VS Code CLI Update** - Approve pending updates  
- **Container Updater: Configure Update Settings** - Open extension settings

### Status Bar

The status bar shows current update status:

- ✅ **Up to date** - No updates available
- ⚠️ **Update Available!** - Click to check details
- ❌ **Check failed** - Error occurred during check

### Update Workflow

1. Extension detects update notification in system logs
2. Shows notification: "VS Code CLI update available: 1.85.0 -> 1.86.0"
3. Click "Approve Update" to create approval file
4. Container's update system automatically installs update on next check cycle
5. Extension confirms update completion

## How It Works

The extension operates entirely within the container by:

1. **Log Monitoring**: Reads the container's entrypoint logs (`~/LOGS/entrypoint-log-*.log`)
2. **Pattern Matching**: Looks for specific update messages like:

   ```text
   Update available for VS Code CLI (installed: 1.85.0, candidate: 1.86.0)
   ```

3. **Approval Mechanism**: Creates the approval file using:

   ```bash
   touch $HOME/APPROVE_CODE_UPDATE
   ```

## Requirements

- VS Code 1.103.0 or higher
- Running inside the containerized VS Code environment
- Access to system logs directory (`~/LOGS`)

## Extension Settings

This extension contributes the following settings:

- `vscode-container-updater.checkInterval`: Check interval in seconds (default: 300)
- `vscode-container-updater.autoCheck`: Enable automatic monitoring (default: true)

## Known Issues

- Only works within the containerized VS Code environment
- Requires access to entrypoint log files
- Parsing relies on specific log message formats from the container's update system

## Release Notes

### 0.0.1

Initial release with basic monitoring and approval functionality.

## Development

To contribute or modify this extension:

```bash
# Install dependencies
npm install

# Compile TypeScript
npm run compile

# Watch for changes during development
npm run watch

# Test in development
# Press F5 in VS Code to launch Extension Development Host
```

## License

This extension follows the same licensing terms as the parent VS Code container project.
